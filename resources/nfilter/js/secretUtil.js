nshc.secretUtilVer=1.4;nshc.cryptoObj=window.crypto||window.msCrypto;var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(canary&16777215);function BigInteger(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function nbi(){return new BigInteger(null)}function am1(a,b,c,d,e,f){for(;0<=--f;){var h=b*this[a++]+c[d]+e;e=Math.floor(h/67108864);c[d++]=h&67108863}return e}
function am2(a,b,c,d,e,f){var h=b&32767;for(b>>=15;0<=--f;){var p=this[a]&32767,g=this[a++]>>15,k=b*p+g*h;p=h*p+((k&32767)<<15)+c[d]+(e&1073741823);e=(p>>>30)+(k>>>15)+b*g+(e>>>30);c[d++]=p&1073741823}return e}function am3(a,b,c,d,e,f){var h=b&16383;for(b>>=14;0<=--f;){var p=this[a]&16383,g=this[a++]>>14,k=b*p+g*h;p=h*p+((k&16383)<<14)+c[d]+e;e=(p>>28)+(k>>14)+b*g;c[d++]=p&268435455}return e}
j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28);BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;
rr=48;for(vv=0;9>=vv;++vv)BI_RC[rr++]=vv;rr=97;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;rr=65;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(a){return BI_RM.charAt(a)}function intAt(a,b){var c=BI_RC[a.charCodeAt(b)];return null==c?-1:c}function bnpCopyTo(a){for(var b=this.t-1;0<=b;--b)a[b]=this[b];a.t=this.t;a.s=this.s}function bnpFromInt(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0}function nbv(a){var b=nbi();b.fromInt(a);return b}
function bnpFromString(a,b){if(16==b)var c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else{this.fromRadix(a,b);return}this.s=this.t=0;for(var d=a.length,e=!1,f=0;0<=--d;){var h=8==c?a[d]&255:intAt(a,d);0>h?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this[this.t++]=h:f+c>this.DB?(this[this.t-1]|=(h&(1<<this.DB-f)-1)<<f,this[this.t++]=h>>this.DB-f):this[this.t-1]|=h<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(a[0]&128)&&(this.s=-1,0<f&&(this[this.t-1]|=(1<<this.DB-
f)-1<<f));this.clamp();e&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t}
function bnToString(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var b=(1<<a)-1,c,d=!1,e="",f=this.t,h=this.DB-f*this.DB%a;if(0<f--)for(h<this.DB&&0<(c=this[f]>>h)&&(d=!0,e=int2char(c));0<=f;)h<a?(c=(this[f]&(1<<h)-1)<<a-h,c|=this[--f]>>(h+=this.DB-a)):(c=this[f]>>(h-=a)&b,0>=h&&(h+=this.DB,--f)),0<c&&(d=!0),d&&(e+=int2char(c));return d?e:"0"}
function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;b=c-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0}function nbits(a){var b=1,c;0!=(c=a>>>16)&&(a=c,b+=16);0!=(c=a>>8)&&(a=c,b+=8);0!=(c=a>>4)&&(a=c,b+=4);0!=(c=a>>2)&&(a=c,b+=2);0!=a>>1&&(b+=1);return b}
function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(a,b){var c;for(c=this.t-1;0<=c;--c)b[c+a]=this[c];for(c=a-1;0<=c;--c)b[c]=0;b.t=this.t+a;b.s=this.s}function bnpDRShiftTo(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0);b.s=this.s}
function bnpLShiftTo(a,b){var c=a%this.DB,d=this.DB-c,e=(1<<d)-1,f=Math.floor(a/this.DB),h=this.s<<c&this.DM,p;for(p=this.t-1;0<=p;--p)b[p+f+1]=this[p]>>d|h,h=(this[p]&e)<<c;for(p=f-1;0<=p;--p)b[p]=0;b[f]=h;b.t=this.t+f+1;b.s=this.s;b.clamp()}
function bnpRShiftTo(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var h=c+1;h<this.t;++h)b[h-c-1]|=(this[h]&f)<<e,b[h-c]=this[h]>>d;0<d&&(b[this.t-c-1]|=(this.s&f)<<e);b.t=this.t-c;b.clamp()}}
function bnpSubTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0;-1>d?b[c++]=this.DV+d:0<d&&(b[c++]=d);b.t=c;b.clamp()}
function bnpMultiplyTo(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;0<=--e;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0;b.clamp();this.s!=a.s&&BigInteger.ZERO.subTo(b,b)}function bnpSquareTo(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1));a.s=0;a.clamp()}
function bnpDivRemTo(a,b,c){var d=a.abs();if(!(0>=d.t)){var e=this.abs();if(e.t<d.t)null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);else{null==c&&(c=nbi());var f=nbi(),h=this.s;a=a.s;var p=this.DB-nbits(d[d.t-1]);0<p?(d.lShiftTo(p,f),e.lShiftTo(p,c)):(d.copyTo(f),e.copyTo(c));d=f.t;e=f[d-1];if(0!=e){var g=e*(1<<this.F1)+(1<d?f[d-2]>>this.F2:0),k=this.FV/g;g=(1<<this.F1)/g;var n=1<<this.F2,r=c.t,l=r-d,q=null==b?nbi():b;f.dlShiftTo(l,q);0<=c.compareTo(q)&&(c[c.t++]=1,c.subTo(q,c));BigInteger.ONE.dlShiftTo(d,
q);for(q.subTo(f,f);f.t<d;)f[f.t++]=0;for(;0<=--l;){var v=c[--r]==e?this.DM:Math.floor(c[r]*k+(c[r-1]+n)*g);if((c[r]+=f.am(0,v,c,l,0,d))<v)for(f.dlShiftTo(l,q),c.subTo(q,c);c[r]<--v;)c.subTo(q,c)}null!=b&&(c.drShiftTo(d,b),h!=a&&BigInteger.ZERO.subTo(b,b));c.t=d;c.clamp();0<p&&c.rShiftTo(p,c);0>h&&BigInteger.ZERO.subTo(c,c)}}}}function bnMod(a){var b=nbi();this.abs().divRemTo(a,null,b);0>this.s&&0<b.compareTo(BigInteger.ZERO)&&a.subTo(b,b);return b}function Classic(a){this.m=a}
function cConvert(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;
function bnpInvDigit(){if(1>this.t)return 0;var a=this[0];if(0==(a&1))return 0;var b=a&3;b=b*(2-(a&15)*b)&15;b=b*(2-(a&255)*b)&255;b=b*(2-((a&65535)*b&65535))&65535;b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}
function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);0>a.s&&0<b.compareTo(BigInteger.ZERO)&&this.m.subTo(b,b);return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}
function montReduce(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}Montgomery.prototype.convert=montConvert;
Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?this[0]&1:this.s)}function bnpExp(a,b){if(4294967295<a||1>a)return BigInteger.ONE;var c=nbi(),d=nbi(),e=b.convert(this),f=nbits(a)-1;for(e.copyTo(c);0<=--f;)if(b.sqrTo(c,d),0<(a&1<<f))b.mulTo(d,e,c);else{var h=c;c=d;d=h}return b.revert(c)}
function bnModPowInt(a,b){var c=256>a||b.isEven()?new Classic(b):new Montgomery(b);return this.exp(a,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;
BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;
BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var a=nbi();this.copyTo(a);return a}function bnIntValue(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}
function bnSigNum(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1}function bnpToRadix(a){null==a&&(a=10);if(0==this.signum()||2>a||36<a)return"0";var b=this.chunkSize(a);b=Math.pow(a,b);var c=nbv(b),d=nbi(),e=nbi(),f="";for(this.divRemTo(c,d,e);0<d.signum();)f=(b+e.intValue()).toString(a).substr(1)+f,d.divRemTo(c,d,e);return e.intValue().toString(a)+f}
function bnpFromRadix(a,b){this.fromInt(0);null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,h=0,p=0;p<a.length;++p){var g=intAt(a,p);0>g?"-"==a.charAt(p)&&0==this.signum()&&(e=!0):(h=b*h+g,++f>=c&&(this.dMultiply(d),this.dAddOffset(h,0),h=f=0))}0<f&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(h,0));e&&BigInteger.ZERO.subTo(this,this)}
function bnpFromNumber(a,b,c){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this);else{c=[];var d=a&7;c.length=(a>>3)+1;b.nextBytes(c);c[0]=0<d?c[0]&(1<<d)-1:0;this.fromString(c,256)}}
function bnToByteArray(){var a=this.t,b=[];b[0]=this.s;var c=this.DB-a*this.DB%8,d,e=0;if(0<a--)for(c<this.DB&&(d=this[a]>>c)!=(this.s&this.DM)>>c&&(b[e++]=d|this.s<<this.DB-c);0<=a;)if(8>c?(d=(this[a]&(1<<c)-1)<<8-c,d|=this[--a]>>(c+=this.DB-8)):(d=this[a]>>(c-=8)&255,0>=c&&(c+=this.DB,--a)),0!=(d&128)&&(d|=-256),0==e&&(this.s&128)!=(d&128)&&++e,0<e||d!=this.s)b[e++]=d;return b}function bnEquals(a){return 0==this.compareTo(a)}function bnMin(a){return 0>this.compareTo(a)?this:a}
function bnMax(a){return 0<this.compareTo(a)?this:a}function bnpBitwiseTo(a,b,c){var d,e=Math.min(a.t,this.t);for(d=0;d<e;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){var f=a.s&this.DM;for(d=e;d<this.t;++d)c[d]=b(this[d],f);c.t=this.t}else{f=this.s&this.DM;for(d=e;d<a.t;++d)c[d]=b(f,a[d]);c.t=a.t}c.s=b(this.s,a.s);c.clamp()}function op_and(a,b){return a&b}function bnAnd(a){var b=nbi();this.bitwiseTo(a,op_and,b);return b}function op_or(a,b){return a|b}
function bnOr(a){var b=nbi();this.bitwiseTo(a,op_or,b);return b}function op_xor(a,b){return a^b}function bnXor(a){var b=nbi();this.bitwiseTo(a,op_xor,b);return b}function op_andnot(a,b){return a&~b}function bnAndNot(a){var b=nbi();this.bitwiseTo(a,op_andnot,b);return b}function bnNot(){for(var a=nbi(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];a.t=this.t;a.s=~this.s;return a}function bnShiftLeft(a){var b=nbi();0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b);return b}
function bnShiftRight(a){var b=nbi();0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b);return b}function lbit(a){if(0==a)return-1;var b=0;0==(a&65535)&&(a>>=16,b+=16);0==(a&255)&&(a>>=8,b+=8);0==(a&15)&&(a>>=4,b+=4);0==(a&3)&&(a>>=2,b+=2);0==(a&1)&&++b;return b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+lbit(this[a]);return 0>this.s?this.t*this.DB:-1}function cbit(a){for(var b=0;0!=a;)a&=a-1,++b;return b}
function bnBitCount(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=cbit(this[c]^b);return a}function bnTestBit(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function bnpChangeBit(a,b){var c=BigInteger.ONE.shiftLeft(a);this.bitwiseTo(c,b,c);return c}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}
function bnpAddTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0;0<d?b[c++]=d:-1>d&&(b[c++]=this.DV+d);b.t=c;b.clamp()}function bnAdd(a){var b=nbi();this.addTo(a,b);return b}function bnSubtract(a){var b=nbi();this.subTo(a,b);return b}
function bnMultiply(a){var b=nbi();this.multiplyTo(a,b);return b}function bnSquare(){var a=nbi();this.squareTo(a);return a}function bnDivide(a){var b=nbi();this.divRemTo(a,b,null);return b}function bnRemainder(a){var b=nbi();this.divRemTo(a,null,b);return b}function bnDivideAndRemainder(a){var b=nbi(),c=nbi();this.divRemTo(a,b,c);return[b,c]}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}
function bnpDAddOffset(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,b,c){a.multiplyTo(b,c)}function nSqrTo(a,b){a.squareTo(b)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(a){return this.exp(a,new NullExp)}
function bnpMultiplyLowerTo(a,b,c){var d=Math.min(this.t+a.t,b);c.s=0;for(c.t=d;0<d;)c[--d]=0;var e;for(e=c.t-this.t;d<e;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);d<e;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function bnpMultiplyUpperTo(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;0<=--d;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp();c.drShiftTo(1,c)}
function Barrett(a){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function barrettConvert(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=nbi();a.copyTo(b);this.reduce(b);return b}function barrettRevert(a){return a}
function barrettReduce(a){a.drShiftTo(this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)}function barrettSqrTo(a,b){a.squareTo(b);this.reduce(b)}function barrettMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}Barrett.prototype.convert=barrettConvert;
Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;
function bnModPow(a,b){var c=a.bitLength(),d=nbv(1);if(0>=c)return d;var e=18>c?1:48>c?3:144>c?4:768>c?5:6,f=8>c?new Classic(b):b.isEven()?new Barrett(b):new Montgomery(b),h=[],p=3,g=e-1,k=(1<<e)-1;h[1]=f.convert(this);if(1<e)for(c=nbi(),f.sqrTo(h[1],c);p<=k;)h[p]=nbi(),f.mulTo(c,h[p-2],h[p]),p+=2;var n=a.t-1,r,l=!0,q=nbi();for(c=nbits(a[n])-1;0<=n;){c>=g?r=a[n]>>c-g&k:(r=(a[n]&(1<<c+1)-1)<<g-c,0<n&&(r|=a[n-1]>>this.DB+c-g));for(p=e;0==(r&1);)r>>=1,--p;0>(c-=p)&&(c+=this.DB,--n);if(l)h[r].copyTo(d),
l=!1;else{for(;1<p;)f.sqrTo(d,q),f.sqrTo(q,d),p-=2;0<p?f.sqrTo(d,q):(p=d,d=q,q=p);f.mulTo(q,h[r],d)}for(;0<=n&&0==(a[n]&1<<c);)f.sqrTo(d,q),p=d,d=q,q=p,0>--c&&(c=this.DB-1,--n)}return f.revert(d)}
function bnGCD(a){var b=0>this.s?this.negate():this.clone();a=0>a.s?a.negate():a.clone();if(0>b.compareTo(a)){var c=b;b=a;a=c}c=b.getLowestSetBit();var d=a.getLowestSetBit();if(0>d)return b;c<d&&(d=c);for(0<d&&(b.rShiftTo(d,b),a.rShiftTo(d,a));0<b.signum();)0<(c=b.getLowestSetBit())&&b.rShiftTo(c,b),0<(c=a.getLowestSetBit())&&a.rShiftTo(c,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));0<d&&a.lShiftTo(d,a);return a}
function bnpModInt(a){if(0>=a)return 0;var b=this.DV%a,c=0>this.s?a-1:0;if(0<this.t)if(0==b)c=this[0]%a;else for(var d=this.t-1;0<=d;--d)c=(b*c+this[d])%a;return c}
function bnModInverse(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return BigInteger.ZERO;for(var c=a.clone(),d=this.clone(),e=nbv(1),f=nbv(0),h=nbv(0),p=nbv(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(h.isEven()&&p.isEven()||(h.addTo(this,h),p.subTo(a,p)),h.rShiftTo(1,h)):p.isEven()||p.subTo(a,p),p.rShiftTo(1,p);0<=c.compareTo(d)?
(c.subTo(d,c),b&&e.subTo(h,e),f.subTo(p,f)):(d.subTo(c,d),b&&h.subTo(e,h),p.subTo(f,p))}if(0!=d.compareTo(BigInteger.ONE))return BigInteger.ZERO;if(0<=p.compareTo(a))return p.subtract(a);if(0>p.signum())p.addTo(a,p);else return p;return 0>p.signum()?p.add(a):p}
var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,
733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=67108864/lowprimes[lowprimes.length-1];
function bnIsProbablePrime(a){var b,c=this.abs();if(1==c.t&&c[0]<=lowprimes[lowprimes.length-1]){for(b=0;b<lowprimes.length;++b)if(c[0]==lowprimes[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<lowprimes.length;){for(var d=lowprimes[b],e=b+1;e<lowprimes.length&&d<lplim;)d*=lowprimes[e++];for(d=c.modInt(d);b<e;)if(0==d%lowprimes[b++])return!1}return c.millerRabin(a)}
function bnpMillerRabin(a){var b=this.subtract(BigInteger.ONE),c=b.getLowestSetBit();if(0>=c)return!1;var d=b.shiftRight(c);a=a+1>>1;a>lowprimes.length&&(a=lowprimes.length);for(var e=nbi(),f=0;f<a;++f){e.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var h=e.modPow(d,this);if(0!=h.compareTo(BigInteger.ONE)&&0!=h.compareTo(b)){for(var p=1;p++<c&&0!=h.compareTo(b);)if(h=h.modPowInt(2,this),0==h.compareTo(BigInteger.ONE))return!1;if(0!=h.compareTo(b))return!1}}return!0}
BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;
BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;
BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;
BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;var rng_psize=256,rng_state,rng_pool,rng_pptr;
function rng_seed_int(a){rng_pool[rng_pptr++]^=a&255;rng_pool[rng_pptr++]^=a>>8&255;rng_pool[rng_pptr++]^=a>>16&255;rng_pool[rng_pptr++]^=a>>24&255;rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}
if(null==rng_pool){rng_pool=[];rng_pptr=0;var t;if(window.crypto&&window.crypto.getRandomValues){var ua=new Uint8Array(32);window.crypto.getRandomValues(ua);for(t=0;32>t;++t)rng_pool[rng_pptr++]=ua[t]}var appVerIdx=navigator.userAgent.indexOf("Mozilla/")+8,appVer=navigator.userAgent.substring(appVerIdx,appVerIdx+1);if("5">appVer&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=z.charCodeAt(t)&255}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),
rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=t&255;rng_pptr=0;rng_seed_time()}function rng_get_bytes(a){var b,c=new Uint8Array(a.length);window.crypto.getRandomValues(c);for(b=0;b<a.length;++b)a[b]=c[b]}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function ECFieldElementFp(a,b){this.x=b;this.q=a}function feFpEquals(a){return a==this?!0:this.q.equals(a.q)&&this.x.equals(a.x)}function feFpToBigInteger(){return this.x}
function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(a){return new ECFieldElementFp(this.q,this.x.add(a.toBigInteger()).mod(this.q))}function feFpSubtract(a){return new ECFieldElementFp(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}function feFpMultiply(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}
function feFpDivide(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;
function ECPointFp(a,b,c,d){this.curve=a;this.x=b;this.y=c;this.z=null==d?BigInteger.ONE:d;this.zinv=null}function pointFpGetX(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var a=this.x.toBigInteger().multiply(this.zinv);this.curve.reduce(a);return this.curve.fromBigInteger(a)}function pointFpGetY(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var a=this.y.toBigInteger().multiply(this.zinv);this.curve.reduce(a);return this.curve.fromBigInteger(a)}
function pointFpEquals(a){return a==this?!0:this.isInfinity()?a.isInfinity():a.isInfinity()?this.isInfinity():a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(BigInteger.ZERO)?a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(BigInteger.ZERO):!1}
function pointFpIsInfinity(){return null==this.x&&null==this.y?!0:this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}
function pointFpAdd(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(c))return BigInteger.ZERO.equals(b)?this.twice():this.curve.getInfinity();var d=new BigInteger("3"),e=this.x.toBigInteger(),f=this.y.toBigInteger();a.x.toBigInteger();a.y.toBigInteger();
var h=c.square(),p=h.multiply(c);e=e.multiply(h);h=b.square().multiply(this.z);c=h.subtract(e.shiftLeft(1)).multiply(a.z).subtract(p).multiply(c).mod(this.curve.q);b=e.multiply(d).multiply(b).subtract(f.multiply(p)).subtract(h.multiply(b)).multiply(a.z).add(b.multiply(p)).mod(this.curve.q);a=p.multiply(this.z).multiply(a.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(b),a)}
function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=new BigInteger("3"),b=this.x.toBigInteger(),c=this.y.toBigInteger(),d=c.multiply(this.z),e=d.multiply(c).mod(this.curve.q);c=this.curve.a.toBigInteger();var f=b.square().multiply(a);BigInteger.ZERO.equals(c)||(f=f.add(this.z.square().multiply(c)));f=f.mod(this.curve.q);c=f.square().subtract(b.shiftLeft(3).multiply(e)).shiftLeft(1).multiply(d).mod(this.curve.q);a=f.multiply(a).multiply(b).subtract(e.shiftLeft(1)).shiftLeft(2).multiply(e).subtract(f.square().multiply(f)).mod(this.curve.q);
d=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(a),d)}function pointFpMultiply(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b=a.multiply(new BigInteger("3")),c=this.negate(),d=this,e;for(e=b.bitLength()-2;0<e;--e){d=d.twice();var f=b.testBit(e),h=a.testBit(e);f!=h&&(d=d.add(f?this:c))}return d}
function pointFpMultiplyTwo(a,b,c){for(var d=a.bitLength()>c.bitLength()?a.bitLength()-1:c.bitLength()-1,e=this.curve.getInfinity(),f=this.add(b);0<=d;)e=e.twice(),a.testBit(d)?e=c.testBit(d)?e.add(f):e.add(this):c.testBit(d)&&(e=e.add(b)),--d;return e}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;
ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(a,b,c){this.q=a;this.a=this.fromBigInteger(b);this.b=this.fromBigInteger(c);this.infinity=new ECPointFp(this,null,null);this.reducer=new Barrett(this.q)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}
function curveFpEquals(a){return a==this?!0:this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(a){return new ECFieldElementFp(this.q,a)}function curveReduce(a){this.reducer.reduce(a)}
function curveFpDecodePointHex(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var b=(a.length-2)/2,c=a.substr(2,b);a=a.substr(b+2,b);return new ECPointFp(this,this.fromBigInteger(new BigInteger(c,16)),this.fromBigInteger(new BigInteger(a,16)));default:return null}}
function curveFpEncodePointHex(a){if(a.isInfinity())return"00";var b=a.getX().toBigInteger().toString(16);a=a.getY().toBigInteger().toString(16);var c=this.getQ().toString(16).length;for(0!=c%2&&c++;b.length<c;)b="0"+b;for(;a.length<c;)a="0"+a;return"04"+b+a}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;
ECCurveFp.prototype.reduce=curveReduce;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;ECCurveFp.prototype.encodePointHex=curveFpEncodePointHex;function X9ECParameters(a,b,c,d){this.curve=a;this.g=b;this.n=c;this.h=d}function x9getCurve(){return this.curve}function x9getG(){return this.g}function x9getN(){return this.n}function x9getH(){return this.h}X9ECParameters.prototype.getCurve=x9getCurve;X9ECParameters.prototype.getG=x9getG;X9ECParameters.prototype.getN=x9getN;
X9ECParameters.prototype.getH=x9getH;function fromHex(a){return new BigInteger(a,16)}function secp128r1(){var a=fromHex("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF"),b=fromHex("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC"),c=fromHex("E87579C11079F43DD824993C2CEE5ED3"),d=fromHex("FFFFFFFE0000000075A30D1B9038A115"),e=BigInteger.ONE;a=new ECCurveFp(a,b,c);b=a.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new X9ECParameters(a,b,d,e)}
function secp160k1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73"),b=BigInteger.ZERO,c=fromHex("7"),d=fromHex("0100000000000000000001B8FA16DFAB9ACA16B6B3"),e=BigInteger.ONE;a=new ECCurveFp(a,b,c);b=a.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new X9ECParameters(a,b,d,e)}
function secp160r1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF"),b=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC"),c=fromHex("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45"),d=fromHex("0100000000000000000001F4C8F927AED3CA752257"),e=BigInteger.ONE;a=new ECCurveFp(a,b,c);b=a.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new X9ECParameters(a,b,d,e)}
function secp192k1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37"),b=BigInteger.ZERO,c=fromHex("3"),d=fromHex("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D"),e=BigInteger.ONE;a=new ECCurveFp(a,b,c);b=a.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new X9ECParameters(a,b,d,e)}
function secp192r1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF"),b=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC"),c=fromHex("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1"),d=fromHex("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831"),e=BigInteger.ONE;a=new ECCurveFp(a,b,c);b=a.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new X9ECParameters(a,b,d,e)}
function secp224r1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001"),b=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE"),c=fromHex("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4"),d=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D"),e=BigInteger.ONE;a=new ECCurveFp(a,b,c);b=a.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new X9ECParameters(a,
b,d,e)}
function secp256r1(){var a=fromHex("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"),b=fromHex("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"),c=fromHex("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"),d=fromHex("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"),e=BigInteger.ONE;a=new ECCurveFp(a,b,c);b=a.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new X9ECParameters(a,
b,d,e)}function getSECCurveByName(a){return"secp128r1"==a?secp128r1():"secp160k1"==a?secp160k1():"secp160r1"==a?secp160r1():"secp192k1"==a?secp192k1():"secp192r1"==a?secp192r1():"secp224r1"==a?secp224r1():"secp256r1"==a?secp256r1():null}
var nSaferJS=nSaferJS||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function l(){}return{extend:function(q){l.prototype=this;var v=new l;q&&v.mixIn(q);v.hasOwnProperty("init")||(v.init=function(){v.$super.init.apply(this,arguments)});v.init.prototype=v;v.$super=this;return v},create:function(){var q=this.extend();q.init.apply(q,arguments);return q},init:function(){},mixIn:function(q){for(var v in q)q.hasOwnProperty(v)&&(this[v]=q[v]);q.hasOwnProperty("toString")&&(this.toString=q.toString)},
clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(l,q){l=this.words=l||[];this.sigBytes=q!=b?q:4*l.length},toString:function(l){return(l||p).stringify(this)},concat:function(l){var q=this.words,v=l.words,m=this.sigBytes;l=l.sigBytes;this.clamp();if(m%4)for(var u=0;u<l;u++)q[m+u>>>2]|=(v[u>>>2]>>>24-u%4*8&255)<<24-(m+u)%4*8;else if(65535<v.length)for(u=0;u<l;u+=4)q[m+u>>>2]=v[u>>>2];else q.push.apply(q,v);this.sigBytes+=l;return this},clamp:function(){var l=
this.words,q=this.sigBytes;l[q>>>2]&=4294967295<<32-q%4*8;l.length=a.ceil(q/4)},clone:function(){var l=e.clone.call(this);l.words=this.words.slice(0);return l},random:function(l){for(var q=[],v=0;v<l;v+=4)q.push(4294967296*a.random()|0);return new f.init(q,l)}}),h=c.enc={},p=h.Hex={stringify:function(l){var q=l.words;l=l.sigBytes;for(var v=[],m=0;m<l;m++){var u=q[m>>>2]>>>24-m%4*8&255;v.push((u>>>4).toString(16));v.push((u&15).toString(16))}return v.join("")},parse:function(l){for(var q=l.length,
v=[],m=0;m<q;m+=2)v[m>>>3]|=parseInt(l.substr(m,2),16)<<24-m%8*4;return new f.init(v,q/2)}},g=h.Latin1={stringify:function(l){var q=l.words;l=l.sigBytes;for(var v=[],m=0;m<l;m++)v.push(String.fromCharCode(q[m>>>2]>>>24-m%4*8&255));return v.join("")},parse:function(l){for(var q=l.length,v=[],m=0;m<q;m++)v[m>>>2]|=(l.charCodeAt(m)&255)<<24-m%4*8;return new f.init(v,q)}},k=h.Utf8={stringify:function(l){try{return decodeURIComponent(escape(g.stringify(l)))}catch(q){throw Error("Malformed UTF-8 data");
}},parse:function(l){return g.parse(unescape(encodeURIComponent(l)))}},n=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init;this._nDataBytes=0},_append:function(l){"string"==typeof l&&(l=k.parse(l));this._data.concat(l);this._nDataBytes+=l.sigBytes},_process:function(l){var q,v=this._data,m=v.words,u=v.sigBytes,w=this.blockSize,x=u/(4*w);x=l?a.ceil(x):a.max((x|0)-this._minBufferSize,0);l=x*w;u=a.min(4*l,u);if(l){for(q=0;q<l;q+=w)this._doProcessBlock(m,q);q=m.splice(0,l);v.sigBytes-=
u}return new f.init(q,u)},clone:function(){var l=e.clone.call(this);l._data=this._data.clone();return l},_minBufferSize:0});d.Hasher=n.extend({cfg:e.extend(),init:function(l){this.cfg=this.cfg.extend(l);this.reset()},reset:function(){n.reset.call(this);this._doReset()},update:function(l){this._append(l);this._process();return this},finalize:function(l){l&&this._append(l);return this._doFinalize()},blockSize:16,_createHelper:function(l){return function(q,v){return(new l.init(v)).finalize(q)}},_createHmacHelper:function(l){return function(q,
v){return(new r.HMAC.init(l,v)).finalize(q)}}});var r=c.algo={};return c}(Math);
(function(){var a=nSaferJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(c){var d=c.words,e=c.sigBytes,f=this._map;c.clamp();c=[];for(var h=0;h<e;h+=3)for(var p=(d[h>>>2]>>>24-h%4*8&255)<<16|(d[h+1>>>2]>>>24-(h+1)%4*8&255)<<8|d[h+2>>>2]>>>24-(h+2)%4*8&255,g=0;4>g&&h+.75*g<e;g++)c.push(f.charAt(p>>>6*(3-g)&63));if(d=f.charAt(64))for(;c.length%4;)c.push(d);return c.join("")},parse:function(c){var d=c.length,e=this._map,f=e.charAt(64);f&&(f=c.indexOf(f),-1!=f&&(d=f));f=[];for(var h=0,p=0;p<d;p++)if(p%
4){var g=e.indexOf(c.charAt(p-1))<<p%4*2,k=e.indexOf(c.charAt(p))>>>6-p%4*2;f[h>>>2]|=(g|k)<<24-h%4*8;h++}return b.create(f,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();
nSaferJS.lib.Cipher||function(a){var b=nSaferJS,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,h=b.enc.Base64,p=b.algo.EvpKDF,g=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(m,u){return this.create(this._ENC_XFORM_MODE,m,u)},createDecryptor:function(m,u){return this.create(this._DEC_XFORM_MODE,m,u)},init:function(m,u,w){this.cfg=this.cfg.extend(w);this._xformMode=m;this._key=u;this.reset()},reset:function(){f.reset.call(this);this._doReset()},process:function(m){this._append(m);
return this._process()},finalize:function(m){m&&this._append(m);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(m){return{encrypt:function(u,w,x){return("string"==typeof w?v:q).encrypt(m,u,w,x)},decrypt:function(u,w,x){return("string"==typeof w?v:q).decrypt(m,u,w,x)}}}}()});c.StreamCipher=g.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var k=b.mode={},n=c.BlockCipherMode=d.extend({createEncryptor:function(m,
u){return this.Encryptor.create(m,u)},createDecryptor:function(m,u){return this.Decryptor.create(m,u)},init:function(m,u){this._cipher=m;this._iv=u}});k=k.CBC=function(){function m(w,x,y){var A;(A=this._iv)?this._iv=a:A=this._prevBlock;for(var B=0;B<y;B++)w[x+B]^=A[B]}var u=n.extend();u.Encryptor=u.extend({processBlock:function(w,x){var y=this._cipher,A=y.blockSize;m.call(this,w,x,A);y.encryptBlock(w,x);this._prevBlock=w.slice(x,x+A)}});u.Decryptor=u.extend({processBlock:function(w,x){var y=this._cipher,
A=y.blockSize,B=w.slice(x,x+A);y.decryptBlock(w,x);m.call(this,w,x,A);this._prevBlock=B}});return u}();var r=(b.pad={}).Pkcs7={pad:function(m,u){var w=4*u;w-=m.sigBytes%w;for(var x=w<<24|w<<16|w<<8|w,y=[],A=0;A<w;A+=4)y.push(x);w=e.create(y,w);m.concat(w)},unpad:function(m){m.sigBytes-=m.words[m.sigBytes-1>>>2]&255}};c.BlockCipher=g.extend({cfg:g.cfg.extend({mode:k,padding:r}),reset:function(){g.reset.call(this);var m=this.cfg,u=m.iv,w=m.mode;this._xformMode==this._ENC_XFORM_MODE?m=w.createEncryptor:
(m=w.createDecryptor,this._minBufferSize=1);this._mode=m.call(w,this,u&&u.words)},_doProcessBlock:function(m,u){this._mode.processBlock(m,u)},_doFinalize:function(){var m=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){m.pad(this._data,this.blockSize);var u=this._process(!0)}else u=this._process(!0),m.unpad(u);return u},blockSize:4});var l=c.CipherParams=d.extend({init:function(m){this.mixIn(m)},toString:function(m){return(m||this.formatter).stringify(this)}});k=(b.format={}).OpenSSL={stringify:function(m){var u=
m.ciphertext;m=m.salt;return(m?e.create([1398893684,1701076831]).concat(m).concat(u):u).toString(h)},parse:function(m){m=h.parse(m);var u=m.words;if(1398893684==u[0]&&1701076831==u[1]){var w=e.create(u.slice(2,4));u.splice(0,4);m.sigBytes-=16}return l.create({ciphertext:m,salt:w})}};var q=c.SerializableCipher=d.extend({cfg:d.extend({format:k}),encrypt:function(m,u,w,x){x=this.cfg.extend(x);var y=m.createEncryptor(w,x);u=y.finalize(u);y=y.cfg;return l.create({ciphertext:u,key:w,iv:y.iv,algorithm:m,
mode:y.mode,padding:y.padding,blockSize:m.blockSize,formatter:x.format})},decrypt:function(m,u,w,x){x=this.cfg.extend(x);u=this._parse(u,x.format);return m.createDecryptor(w,x).finalize(u.ciphertext)},_parse:function(m,u){return"string"==typeof m?u.parse(m,this):m}});b=(b.kdf={}).OpenSSL={execute:function(m,u,w,x){x||(x=e.random(8));m=p.create({keySize:u+w}).compute(m,x);w=e.create(m.words.slice(u),4*w);m.sigBytes=4*u;return l.create({key:m,iv:w,salt:x})}};var v=c.PasswordBasedCipher=q.extend({cfg:q.cfg.extend({kdf:b}),
encrypt:function(m,u,w,x){x=this.cfg.extend(x);w=x.kdf.execute(w,m.keySize,m.ivSize);x.iv=w.iv;m=q.encrypt.call(this,m,u,w.key,x);m.mixIn(w);return m},decrypt:function(m,u,w,x){x=this.cfg.extend(x);u=this._parse(u,x.format);w=x.kdf.execute(w,m.keySize,m.ivSize,u.salt);x.iv=w.iv;return q.decrypt.call(this,m,u,w.key,x)}})}();nSaferJS.pad.NoPadding={pad:function(){},unpad:function(){}};
(function(){function a(h){return d[3][h>>>24&255]^d[2][h>>>16&255]^d[1][h>>>8&255]^d[0][h&255]}var b=nSaferJS,c=b.lib.BlockCipher,d=[[696885672,92635524,382128852,331600848,340021332,487395612,747413676,621093156,491606364,54739776,403181592,504238620,289493328,1020063996,181060296,591618912,671621160,71581764,536879136,495817116,549511392,583197408,147374280,386339604,629514660,261063564,50529024,994800504,999011256,318968592,314757840,785310444,809529456,210534540,1057960764,680042664,839004720,
500027868,919007988,876900468,751624428,361075092,185271048,390550356,474763356,457921368,1032696252,16843008,604250148,470552604,860058480,411603096,268439568,214745292,851636976,432656856,738992172,667411428,843215472,58950528,462132120,297914832,109478532,164217288,541089888,272650320,595829664,734782440,218956044,914797236,512660124,256852812,931640244,441078360,113689284,944271480,646357668,302125584,797942700,365285844,557932896,63161280,881111220,21053760,306336336,1028485500,227377548,134742024,
521081628,428446104,0,420024600,67371012,323179344,935850996,566354400,1036907004,910586484,789521196,654779172,813740208,193692552,235799052,730571688,578986656,776888940,327390096,223166796,692674920,1011642492,151585032,168428040,1066382268,802153452,868479984,96846276,126321540,335810580,1053750012,608460900,516870876,772678188,189481800,436867608,101057028,553722144,726360936,642146916,33686016,902164980,310547088,176849544,202113036,864269232,1045328508,281071824,977957496,122110788,377918100,
633725412,637936164,8421504,764256684,533713884,562143648,805318704,923218740,781099692,906375732,352653588,570565152,940060728,885321972,663200676,88424772,206323788,25264512,701096424,75792516,394761108,889532724,197903304,248431308,1007431740,826372464,285282576,130532292,160006536,893743476,1003222008,449499864,952692984,344232084,424235352,42107520,80003268,1070593020,155795784,956903736,658989924,12632256,265274316,398971860,948482232,252642060,244220556,37896768,587408160,293704080,743202924,
466342872,612671652,872689716,834793968,138952776,46318272,793731948,1024274748,755835180,4210752,1049539260,1041117756,1015853244,29475264,713728680,982168248,240009804,356864340,990589752,483184860,675831912,1062171516,478974108,415813848,172638792,373707348,927429492,545300640,768467436,105267780,897954228,722150184,625303908,986379E3,600040416,965325240,830583216,529503132,508449372,969535992,650568420,847426224,822161712,717939432,760045932,525292380,616882404,817950960,231588300,143163528,369496596,
973746744,407392344,348442836,574775904,688464168,117900036,855847728,684253416,453710616,84214020,961114488,276861072,709517928,705307176,445289112],[943196208,3894986976,741149985,2753988258,3423588291,3693006546,2956166067,3090712752,2888798115,1612726368,1410680145,3288844227,1141130304,1815039843,1747667811,1478183763,3221472195,1612857954,808649523,3023406513,673777953,2686484640,3760374498,2754054051,3490956243,2417066385,269549841,67503618,471600144,3158084784,875955762,1208699715,3962556387,
2282260608,1814842464,2821228704,337053459,3288646848,336987666,4097098992,3221406402,1141196097,3760308705,3558262482,1010765619,1010634033,2349764226,2551744656,673712160,1276005954,4097230578,1010699826,2753922465,4164536817,202181889,3693072339,3625502928,673909539,1680229986,2017086066,606537507,741281571,4029792753,1882342002,1073889858,3558130896,1073824065,3221274816,1882407795,1680295779,2888600736,2282457987,4097296371,2888666529,2147516544,471797523,3356150466,741084192,2821360290,875824176,
3490890450,134941443,3962490594,3895052769,1545424209,2484372624,404228112,4164471024,1410811731,2888732322,134744064,3288712641,269681427,3423456705,2215020162,3090778545,4232040435,2084392305,3221340609,808517937,4097164785,2282392194,1747602018,2956034481,3490824657,538968096,3558328275,131586,539099682,67372032,1747470432,1882276209,67569411,3625700307,2619182481,2551810449,1612792161,3158216370,3827746530,1478052177,3692940753,1343308113,2417000592,3692874960,2551876242,2686682019,2821426083,
3490758864,2147582337,202313475,1141327683,404359698,3760440291,3962359008,2349698433,3158282163,2484504210,2017151859,1545358416,2686616226,2686550433,1612923747,539165475,1275940161,3356018880,2619248274,2619116688,943327794,202116096,741215778,3090844338,1814974050,2619314067,1478117970,4029858546,2417132178,4029924339,1208568129,2016954480,3423390912,336921873,4164668403,1882210416,1949648241,2084523891,875889969,269484048,197379,1680098400,1814908257,3288778434,1949582448,3558196689,3023340720,
3895118562,134809857,1949714034,404293905,4231974642,1073758272,269615634,3760242912,3158150577,67437825,4164602610,65793,4029726960,673843746,1545490002,2821294497,1410745938,1073955651,2214954369,336856080,2282326401,2551942035,2955968688,3827680737,1208502336,2017020273,2484570003,4231843056,471731730,2147648130,539033889,2349632640,404425491,1545555795,1949779827,1410614352,2956100274,471665937,606405921,1276071747,0,1141261890,3962424801,1477986384,1343373906,3895184355,2084458098,3625634514,
3356084673,4231908849,808452144,2484438417,1680164193,1010568240,3023472306,3827614944,3090910131,2084326512,202247682,1343242320,943262001,606471714,808583730,2214888576,1747536225,2417197971,876021555,3827812323,606340128,2753856672,3356216259,1343439699,134875650,2215085955,3625568721,1275874368,2147713923,2349830019,3423522498,943393587,1208633922,3023538099],[2712152457,2172913029,3537114822,3553629123,1347687492,287055117,2695638156,556016901,1364991309,1128268611,270014472,303832590,1364201793,
4043062476,3267889866,1667244867,539502600,1078199364,538976256,2442927501,3772784832,3806339778,3234334920,320083719,2711889285,2206994319,50332419,1937259339,3015195531,319820547,3536851650,3807129294,1886400576,2156661900,859586319,2695374984,842019330,3520863693,4076091078,1886663748,3773574348,2442401157,50858763,1398019911,1348213836,1398283083,2981903757,16777473,539239428,270277644,1936732995,2425886856,269488128,3234598092,4075827906,3520600521,539765772,3823380423,1919955522,2206204803,
2476219275,3520074177,2189690502,3251112393,1616912448,1347424320,2745181059,3823643595,17566989,2998154886,2459704974,1129058127,3014932359,1381505610,3267626694,1886926920,2728666758,303043074,2745970575,3520337349,1633689921,3284140995,2964599940,1094713665,1380979266,1903967565,2173439373,526344,320610063,2442664329,0,286791945,263172,1397756739,4092868551,3789562305,4059839949,1920218694,590098191,589571847,2964336768,2206731147,34344462,2745707403,2728403586,1651256910,2475692931,1095503181,
1634216265,1887190092,17303817,34081290,3015458703,3823906767,4092605379,3250849221,2206467975,269751300,4076617422,1617175620,3537641166,573320718,1128794955,303569418,33818118,555753729,1667771211,1650730566,33554946,4059313605,2458915458,2189953674,789516,3014669187,1920745038,3503296704,1920481866,1128531783,2459178630,3789825477,572794374,2155872384,2712415629,3554418639,2711626113,808464384,859059975,2729193102,842282502,286528773,572531202,808990728,4042536132,2745444231,1094976837,1078725708,
2172649857,3790088649,2156135556,2475956103,825505029,3284667339,3268153038,809253900,1903178049,286265601,3284404167,2173176201,1903441221,4093131723,3537377994,4042799304,2425623684,1364728137,2189427330,3234071748,4093394895,1095240009,825768201,1667508039,3233808576,3284930511,3553892295,2964863112,51121935,2190216846,1111491138,589308675,2442137985,1617701964,3554155467,2695111812,808727556,4059050433,1078462536,3267363522,1668034383,826031373,556543245,1077936192,2998681230,842808846,2965126284,
3250586049,2728929930,2998418058,1112280654,1364464965,859323147,3504086220,1617438792,1937522511,2426150028,3503823048,1112017482,1381242438,1936996167,2694848640,3790351821,1111754310,2981377413,589835019,1633953093,4076354250,3823117251,2981640585,2981114241,2476482447,1381768782,4059576777,3806602950,2997891714,825241857,3806866122,1634479437,1398546255,3773048004,4042272960,3251375565,2156398728,303306246,842545674,1347950664,3503559876,1650467394,556280073,50595591,858796803,3773311176,320346891,
17040645,1903704393,2425360512,1650993738,573057546,2459441802],[137377848,3370182696,220277805,2258805798,3485715471,3469925406,2209591347,2293282872,2409868335,1080057888,1162957845,3351495687,1145062404,1331915823,1264805931,1263753243,3284385795,1113743394,53686323,2243015733,153167913,2158010400,3269648418,2275648551,3285438483,2173800465,17895441,100795398,202382364,2360392764,103953462,1262700555,3487820847,2290124808,1281387564,2292230184,118690839,3300967428,101848086,3304125492,3267543042,
1161905157,3252805665,3335705622,255015999,221330493,2390920206,2291177496,136325160,1312967694,3337810998,238173246,2241963045,3388078137,218172429,3486768159,3369130008,186853419,1180853286,1249015866,119743527,253963311,3253858353,1114796082,1111638018,3302020116,1094795265,3233857536,1131638835,1197696039,2359340076,2340653067,3354653751,2376182829,2155905024,252910623,3401762826,203435052,2325915690,70267956,3268595730,184748043,3470978094,3387025449,1297177629,2224067604,135272472,3371235384,
1196643351,2393025582,134219784,3317810181,51580947,3452029965,2256700422,2310125625,3488873535,1299283005,3250700289,20000817,3320968245,2323810314,1247963178,2175905841,3251752977,2105376,3352548375,33685506,35790882,67109892,1214277672,1097953329,117638151,3419658267,2375130141,2308020249,1096900641,2394078270,3336758310,1230067737,3453082653,1095847953,2156957712,3436239900,2324863002,2208538659,2342758443,3234910224,2172747777,251857935,1195590663,168957978,3286491171,3437292588,2374077453,2410921023,
2257753110,1265858619,1280334876,2191695906,2174853153,1130586147,52633635,1296124941,3368077320,2391972894,2358287388,171063354,201329676,237120558,2326968378,1315073070,2408815647,1246910490,3270701106,2190643218,3287543859,1229015049,1215330360,3435187212,85005333,3421763643,1081110576,1165063221,1332968511,87110709,1052688,50528259,1147167780,1298230317,3334652934,1148220468,3318862869,2226172980,3403868202,151062537,1181905974,152115225,3472030782,1077952512,34738194,3235962912,2377235517,83952645,
3404920890,16842753,3237015600,170010666,1314020382,2309072937,1179800598,1128480771,2239857669,68162580,2306967561,2341705755,2159063088,3319915557,1212172296,1232173113,2274595863,3438345276,236067870,2189590530,18948129,2357234700,185800731,1330863135,1198748727,1146115092,2192748594,219225117,86058021,1329810447,0,1178747910,3454135341,1213224984,1112690706,3420710955,1316125758,3402815514,3384920073,3455188029,3158064,2240910357,1164010533,204487740,2259858486,3303072804,2343811131,1282440252,
235015182,1079005200,154220601,102900774,36843570,2223014916,1231120425,2207485971,120796215,3353601063,69215268,2225120292,3418605579,1129533459,167905290,2273543175,3385972761,1279282188,2206433283,2407762959,3468872718,187906107,1245857802,2276701239]],e=[2654435769,1013904243,2027808486,4055616972,3816266649,3337566003,2380164711,465362127,930724254,1861448508,3722897016,3150826737,2006686179,4013372358,3731777421,3168587547],f=b.algo.SEED=c.extend({_doReset:function(){var h=this._key,p=h.words[0],
g=h.words[1],k=h.words[2];h=h.words[3];for(var n=[],r=0;16>r;r++)if(n[r]=[],n[r][0]=a(p+k-e[r]),n[r][1]=a(g-h+e[r]),0==r%2){var l=p;p=p>>>8|g<<24;g=g>>>8|l<<24}else l=k,k=k<<8|h>>>24,h=h<<8|l>>>24;this._roundKeys=n;this._invRoundKeys=n.slice().reverse()},encryptBlock:function(h,p){this._doCryptBlock(h,p,this._roundKeys)},decryptBlock:function(h,p){this._doCryptBlock(h,p,this._invRoundKeys)},_doCryptBlock:function(h,p,g){var k=h.slice(p,p+2),n=h.slice(p+2,p+4),r=[k,n];for(k=0;16>k;k++){n=g[k];var l=
r[0];r=r[1];var q=[];q[0]=r[0]^n[0];q[1]=r[1]^n[1];q[1]^=q[0];q[1]=a(q[1]);q[0]+=q[1];q[0]=a(q[0]);q[1]+=q[0];q[1]=a(q[1]);q[0]+=q[1];l[0]^=q[0];l[1]^=q[1];r=[r,l]}r.reverse();h.splice(p,4,r[0][0],r[0][1],r[1][0],r[1][1])},keySize:4,ivSize:4,blockSize:4});b.SEED=c._createHelper(f)})();
nSaferJS.mode.CFB=function(){function a(c,d,e,f){var h;(h=this._iv)?(h=h.slice(0),this._iv=void 0):h=this._prevBlock;f.encryptBlock(h,0);for(f=0;f<e;f++)c[d+f]^=h[f]}var b=nSaferJS.lib.BlockCipherMode.extend();b.Encryptor=b.extend({processBlock:function(c,d){var e=this._cipher,f=e.blockSize;a.call(this,c,d,f,e);this._prevBlock=c.slice(d,d+f)}});b.Decryptor=b.extend({processBlock:function(c,d){var e=this._cipher,f=e.blockSize,h=c.slice(d,d+f);a.call(this,c,d,f,e);this._prevBlock=h}});return b}();
function GenECKeyPair(a){a=getSECCurveByName(a);var b=new SecureRandom,c=new BigInteger(a.getN().toString()),d=c.subtract(BigInteger.ONE);b=(new BigInteger(c.bitLength(),b)).mod(d).add(BigInteger.ONE);c=new ECCurveFp(new BigInteger(a.getCurve().getQ().toString()),new BigInteger(a.getCurve().getA().toBigInteger().toString()),new BigInteger(a.getCurve().getB().toBigInteger().toString()));a=new ECPointFp(c,c.fromBigInteger(new BigInteger(a.getG().getX().toBigInteger().toString())),c.fromBigInteger(new BigInteger(a.getG().getY().toBigInteger().toString())));
this.priKey=b.toString(16);this.pubKey=c.encodePointHex(a.multiply(b))}function getECPrivateKey(){return this.priKey}function getECPublicKey(){return this.pubKey}GenECKeyPair.prototype.getPriKey=getECPrivateKey;GenECKeyPair.prototype.getPubKey=getECPublicKey;
function DeriveECKey(a,b,c){a=getSECCurveByName(a);c=(new ECCurveFp(new BigInteger(a.getCurve().getQ().toString()),new BigInteger(a.getCurve().getA().toBigInteger().toString()),new BigInteger(a.getCurve().getB().toBigInteger().toString()))).decodePointHex(c);b=new BigInteger(b,16);b=c.multiply(b).getX().toBigInteger().toString(16);return HexStrCheck(b)}
function SEEDEncrypt(a,b,c){if(a!=nSaferJS.mode.CFB||32!=b.length)return"";var d=nSaferJS.enc.Hex.parse(b);b=nSaferJS.enc.Hex.parse(Sha256(b).substr(0,32));return nSaferJS.SEED.encrypt(c,d,{iv:b,mode:a,padding:nSaferJS.pad.NoPadding}).ciphertext.toString()}
function SEEDDecrypt(a,b,c){if(a!=nSaferJS.mode.CFB||32!=b.length)return"";var d=nSaferJS.enc.Hex.parse(b);b=nSaferJS.enc.Hex.parse(Sha256(b).substr(0,32));return nSaferJS.SEED.decrypt(HexStr2Base64(c),d,{iv:b,mode:a,padding:nSaferJS.pad.NoPadding}).toString()}
function SEEDEncrypt_IV(a,b,c,d){if(a!=nSaferJS.mode.CFB||32!=b.length||32!=c.length)return"";c=nSaferJS.enc.Hex.parse(c);b=nSaferJS.enc.Hex.parse(b);return nSaferJS.SEED.encrypt(d,c,{iv:b,mode:a,padding:nSaferJS.pad.NoPadding}).ciphertext.toString()}
function SEEDDecrypt_IV(a,b,c,d){if(a!=nSaferJS.mode.CFB||32!=b.length||32!=c.length)return"";c=nSaferJS.enc.Hex.parse(c);b=nSaferJS.enc.Hex.parse(b);return nSaferJS.SEED.decrypt(HexStr2Base64(d),c,{iv:b,mode:a,padding:nSaferJS.pad.NoPadding}).toString()}function Sha256(a){return nSaferJS.SHA256(nSaferJS.enc.Hex.parse(a)).toString()}function HexStr2Base64(a){return nSaferJS.enc.Base64.stringify(nSaferJS.enc.Hex.parse(a))}
function Base642HexStr(a){return nSaferJS.enc.Hex.stringify(nSaferJS.enc.Base64.parse(a))}function HexStr2Utf8(a){return nSaferJS.enc.Hex.parse(a).toString(nSaferJS.enc.Utf8)}function Utf82HexStr(a){return nSaferJS.enc.Hex.stringify(nSaferJS.enc.Utf8.parse(a))}function HexStrCheck(a){return a.length%2?"0"+a:a}
(function(){function a(b){this.buf=[+b||0]}a.prototype.mulAdd=function(b,c){var d=this.buf,e=d.length,f;for(f=0;f<e;++f){var h=d[f]*b+c;1E13>h?c=0:(c=0|h/1E13,h-=1E13*c);d[f]=h}0<c&&(d[f]=c)};a.prototype.toString=function(b){if(10!=(b||10))throw"only base 10 is supported";b=this.buf;for(var c=b[b.length-1].toString(),d=b.length-2;0<=d;--d)c+=(1E13+b[d]).toString().substring(1);return c};a.prototype.valueOf=function(){for(var b=this.buf,c=0,d=b.length-1;0<=d;--d)c=1E13*c+b[d];return c};a.prototype.simplify=
function(){var b=this.buf;return 1==b.length?b[0]:this};"undefined"!==typeof module?module.exports=a:window.Int10=a})();
(function(a){function b(g,k){g.length>k&&(g=g.substring(0,k)+"\u2026");return g}function c(g,k){g instanceof c?(this.enc=g.enc,this.pos=g.pos):(this.enc=g,this.pos=k)}function d(g,k,n,r,l){if(!(r instanceof e))throw"Invalid tag value.";this.stream=g;this.header=k;this.length=n;this.tag=r;this.sub=l}function e(g){var k=g.get();this.tagClass=k>>6;this.tagConstructed=0!==(k&32);this.tagNumber=k&31;if(31==this.tagNumber){var n=new f;do k=g.get(),n.mulAdd(128,k&127);while(k&128);this.tagNumber=n.simplify()}}
var f="undefined"!==typeof module?require("./int10.js"):window.Int10,h=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,p=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;c.prototype.get=function(g){g===a&&(g=this.pos++);if(g>=this.enc.length)throw"Requesting byte offset "+g+" on a stream of length "+this.enc.length;
return"string"==typeof this.enc?this.enc.charCodeAt(g):this.enc[g]};c.prototype.hexDigits="0123456789ABCDEF";c.prototype.hexByte=function(g){return this.hexDigits.charAt(g>>4&15)+this.hexDigits.charAt(g&15)};c.prototype.hexDump=function(g,k,n){for(var r="";g<k;++g)if(r+=this.hexByte(this.get(g)),!0!==n)switch(g&15){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}return r};c.prototype.isASCII=function(g,k){for(var n=g;n<k;++n){var r=this.get(n);if(32>r||176<r)return!1}return!0};c.prototype.parseStringISO=
function(g,k){for(var n="",r=g;r<k;++r)n+=String.fromCharCode(this.get(r));return n};c.prototype.parseStringUTF=function(g,k){for(var n="",r=g;r<k;){var l=this.get(r++);n=128>l?n+String.fromCharCode(l):191<l&&224>l?n+String.fromCharCode((l&31)<<6|this.get(r++)&63):n+String.fromCharCode((l&15)<<12|(this.get(r++)&63)<<6|this.get(r++)&63)}return n};c.prototype.parseStringBMP=function(g,k){for(var n="",r,l,q=g;q<k;)r=this.get(q++),l=this.get(q++),n+=String.fromCharCode(r<<8|l);return n};c.prototype.parseTime=
function(g,k,n){g=this.parseStringISO(g,k);k=(n?h:p).exec(g);if(!k)return"Unrecognized time: "+g;n&&(k[1]=+k[1],k[1]+=70>k[1]?2E3:1900);g=k[1]+"-"+k[2]+"-"+k[3]+" "+k[4];k[5]&&(g+=":"+k[5],k[6]&&(g+=":"+k[6],k[7]&&(g+="."+k[7])));k[8]&&(g+=" UTC","Z"!=k[8]&&(g+=k[8],k[9]&&(g+=":"+k[9])));return g};c.prototype.parseInteger=function(g,k){for(var n=this.get(g),r=127<n,l=r?255:0,q,v="";n==l&&++g<k;)n=this.get(g);q=k-g;if(0===q)return r?-1:0;if(4<q){v=n;for(q<<=3;0==((v^l)&128);)v<<=1,--q;v="("+q+" bit)\n"}r&&
(n-=256);n=new f(n);for(r=g+1;r<k;++r)n.mulAdd(256,this.get(r));return v+n.toString()};c.prototype.parseBitString=function(g,k,n){var r=this.get(g),l="("+((k-g-1<<3)-r)+" bit)\n",q="";for(g+=1;g<k;++g){for(var v=this.get(g),m=g==k-1?r:0,u=7;u>=m;--u)q+=v>>u&1?"1":"0";if(q.length>n)return l+b(q,n)}return l+q};c.prototype.parseOctetString=function(g,k,n){if(this.isASCII(g,k))return b(this.parseStringISO(g,k),n);var r=k-g,l="("+r+" byte)\n";n/=2;for(r>n&&(k=g+n);g<k;++g)l+=this.hexByte(this.get(g));
r>n&&(l+="\u2026");return l};c.prototype.parseOID=function(g,k,n){for(var r="",l=new f,q=0;g<k;++g){var v=this.get(g);l.mulAdd(128,v&127);q+=7;if(!(v&128)){""===r?(l=l.simplify(),r=80>l?40>l?0:1:2,r=r+"."+(l-40*r)):r+="."+l.toString();if(r.length>n)return b(r,n);l=new f;q=0}}0<q&&(r+=".incomplete");return r};d.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";
case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";
case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}};d.prototype.content=function(g){if(this.tag===a)return null;g===a&&(g=Infinity);var k=this.posContent(),n=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":
this.stream.parseOctetString(k,k+n,g);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(k)?"false":"true";case 2:return this.stream.parseInteger(k,k+n);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(k,k+n,g);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(k,k+n,g);case 6:return this.stream.parseOID(k,k+n,g);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return b(this.stream.parseStringUTF(k,
k+n),g);case 18:case 19:case 20:case 21:case 22:case 26:return b(this.stream.parseStringISO(k,k+n),g);case 30:return b(this.stream.parseStringBMP(k,k+n),g);case 23:case 24:return this.stream.parseTime(k,k+n,23==this.tag.tagNumber)}return null};d.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"};d.prototype.toPrettyString=function(g){g===a&&(g="");var k=g+this.typeName()+" @"+
this.stream.pos;0<=this.length&&(k+="+");k+=this.length;this.tag.tagConstructed?k+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(k+=" (encapsulates)");k+="\n";if(null!==this.sub){g+="  ";for(var n=0,r=this.sub.length;n<r;++n)k+=this.sub[n].toPrettyString(g)}return k};d.prototype.posStart=function(){return this.stream.pos};d.prototype.posContent=function(){return this.stream.pos+this.header};d.prototype.posEnd=function(){return this.stream.pos+
this.header+Math.abs(this.length)};d.prototype.toHexString=function(g){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)};d.decodeLength=function(g){var k=g.get(),n=k&127;if(n==k)return n;if(6<n)throw"Length over 48 bits not supported at position "+(g.pos-1);if(0===n)return null;for(var r=k=0;r<n;++r)k=256*k+g.get();return k};e.prototype.isUniversal=function(){return 0===this.tagClass};e.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber};d.decode=function(g){g instanceof
c||(g=new c(g,0));var k=new c(g),n=new e(g),r=d.decodeLength(g),l=g.pos,q=l-k.pos,v=null,m=function(){v=[];if(null!==r){for(var u=l+r;g.pos<u;)v[v.length]=d.decode(g);if(g.pos!=u)throw"Content size is not correct for container starting at offset "+l;}else try{for(;;){u=d.decode(g);if(u.tag.isEOC())break;v[v.length]=u}r=l-g.pos}catch(w){throw"Exception while decoding undefined length content: "+w;}};if(n.tagConstructed)m();else if(n.isUniversal()&&(3==n.tagNumber||4==n.tagNumber))try{if(3==n.tagNumber&&
0!=g.get())throw"BIT STRINGs with unused bits cannot encapsulate.";m();for(m=0;m<v.length;++m)if(v[m].tag.isEOC())throw"EOC is not supposed to be actual content.";}catch(u){v=null}if(null===v){if(null===r)throw"We can't skip over an invalid tag with undefined length at offset "+l;g.pos=l+Math.abs(r)}return new d(k,q,r,n,v)};"undefined"!==typeof module?module.exports=d:window.ASN1=d})();
(function(a){var b={},c;b.decode=function(d){var e;if(c===a){c=[];for(e=0;64>e;++e)c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)]=e;for(e=0;9>e;++e)c["= \f\n\r\t\u00a0\u2028\u2029".charAt(e)]=-1}var f=[],h=0,p=0;for(e=0;e<d.length;++e){var g=d.charAt(e);if("="==g)break;g=c[g];if(-1!=g){if(g===a)throw"Illegal character at offset "+e;h|=g;4<=++p?(f[f.length]=h>>16,f[f.length]=h>>8&255,f[f.length]=h&255,p=h=0):h<<=6}}switch(p){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";
case 2:f[f.length]=h>>10;break;case 3:f[f.length]=h>>16,f[f.length]=h>>8&255}return f};b.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/;b.unarmor=function(d){var e=b.re.exec(d);if(e)if(e[1])d=e[1];else if(e[2])d=e[2];else throw"RegExp out of sync";return b.decode(d)};"undefined"!==typeof module?module.exports=b:window.Base64=b})();
(function(a){var b=nSaferJS,c=b.lib,d=c.WordArray,e=c.Hasher;c=b.algo;var f=[],h=[];(function(){function g(l){for(var q=a.sqrt(l),v=2;v<=q;v++)if(!(l%v))return!1;return!0}function k(l){return 4294967296*(l-(l|0))|0}for(var n=2,r=0;64>r;)g(n)&&(8>r&&(f[r]=k(a.pow(n,.5))),h[r]=k(a.pow(n,1/3)),r++),n++})();var p=[];c=c.SHA256=e.extend({_doReset:function(){this._hash=new d.init(f.slice(0))},_doProcessBlock:function(g,k){for(var n=this._hash.words,r=n[0],l=n[1],q=n[2],v=n[3],m=n[4],u=n[5],w=n[6],x=n[7],
y=0;64>y;y++){if(16>y)p[y]=g[k+y]|0;else{var A=p[y-15],B=p[y-2];p[y]=((A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3)+p[y-7]+((B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10)+p[y-16]}A=x+((m<<26|m>>>6)^(m<<21|m>>>11)^(m<<7|m>>>25))+(m&u^~m&w)+h[y]+p[y];B=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&l^r&q^l&q);x=w;w=u;u=m;m=v+A|0;v=q;q=l;l=r;r=A+B|0}n[0]=n[0]+r|0;n[1]=n[1]+l|0;n[2]=n[2]+q|0;n[3]=n[3]+v|0;n[4]=n[4]+m|0;n[5]=n[5]+u|0;n[6]=n[6]+w|0;n[7]=n[7]+x|0},_doFinalize:function(){var g=this._data,k=g.words,n=8*this._nDataBytes,
r=8*g.sigBytes;k[r>>>5]|=128<<24-r%32;k[(r+64>>>9<<4)+14]=a.floor(n/4294967296);k[(r+64>>>9<<4)+15]=n;g.sigBytes=4*k.length;this._process();return this._hash},clone:function(){var g=e.clone.call(this);g._hash=this._hash.clone();return g}});b.SHA256=e._createHelper(c);b.HmacSHA256=e._createHmacHelper(c)})(Math);nshc.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";nshc.B64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";nshc.B64padchar="=";
nshc.keyLength=2048;nshc.encode64=function(a){a=escape(a);var b="",c=0;do{var d=a.charCodeAt(c++);var e=a.charCodeAt(c++);var f=a.charCodeAt(c++);var h=d>>2;d=(d&3)<<4|e>>4;var p=(e&15)<<2|f>>6;var g=f&63;isNaN(e)?p=g=64:isNaN(f)&&(g=64);b=b+nshc.keyStr.charAt(h)+nshc.keyStr.charAt(d)+nshc.keyStr.charAt(p)+nshc.keyStr.charAt(g)}while(c<a.length);return b};
nshc.decode64=function(a){var b="",c=0;/[^A-Za-z0-9\+\/=]/g.exec(a);a=a.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var d=nshc.keyStr.indexOf(a.charAt(c++));var e=nshc.keyStr.indexOf(a.charAt(c++));var f=nshc.keyStr.indexOf(a.charAt(c++));var h=nshc.keyStr.indexOf(a.charAt(c++));d=d<<2|e>>4;e=(e&15)<<4|f>>2;var p=(f&3)<<6|h;b+=String.fromCharCode(d);64!=f&&(b+=String.fromCharCode(e));64!=h&&(b+=String.fromCharCode(p))}while(c<a.length);return unescape(b)};
nshc.hex2b64=function(a){var b,c="";for(b=0;b+3<=a.length;b+=3){var d=parseInt(a.substring(b,b+3),16);c+=nshc.B64map.charAt(d>>6)+nshc.B64map.charAt(d&63)}b+1==a.length?(d=parseInt(a.substring(b,b+1),16),c+=nshc.B64map.charAt(d<<2)):b+2==a.length&&(d=parseInt(a.substring(b,b+2),16),c+=nshc.B64map.charAt(d>>2)+nshc.B64map.charAt((d&3)<<4));for(;0<(c.length&3);)c+=nshc.B64padchar;return c};nshc.parseBigInt=function(a,b){return new BigInteger(a,b)};
nshc.linebrk=function(a,b){for(var c="",d=0;d+b<a.length;)c+=a.substring(d,d+b)+"\n",d+=b;return c+a.substring(d,a.length)};nshc.byte2Hex=function(a){return 16>a?"0"+a.toString(16):a.toString(16)};
nshc.pkcs1pad2=function(a,b){if(b<a.length+11)return alert("Message too long for RSA"),null;for(var c=[],d=a.length-1;0<=d&&0<b;){var e=a.charCodeAt(d--);128>e?c[--b]=e:127<e&&2048>e?(c[--b]=e&63|128,c[--b]=e>>6|192):(c[--b]=e&63|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;d=new SecureRandom;for(e=[];2<b;){for(e[0]=0;0==e[0];)d.nextBytes(e);c[--b]=e[0]}c[--b]=2;c[--b]=0;return new BigInteger(c)};
nshc.RSAKey=function(){this.n=null;this.e=0;this.coeff=this.dmq1=this.dmp1=this.q=this.p=this.d=null};nshc.RSASetPublic=function(a,b){null!=a&&null!=b&&0<a.length&&0<b.length?(this.n=nshc.parseBigInt(a,16),this.e=parseInt(b,16)):alert("Invalid RSA public key")};nshc.RSADoPublic=function(a){return a.modPowInt(this.e,this.n)};nshc.RSAEncrypt=function(a){a=nshc.pkcs1pad2(a,this.n.bitLength()+7>>3);if(null==a)return null;a=this.doPublic(a);if(null==a)return null;a=a.toString(16);return nshc.RSAPaddingCheck(a)};
nshc.hexToBytes=function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b};nshc.bytesToHex=function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")};
nshc.inputEncryptRSA=function(a,b){var c="";if(256==a.length||512==a.length)return a;var d=new nshc.RSAKey;void 0!=b&&null!=b&&""!=b&&(nshc.inputDisplayElement=b);if(""!=nshc.certField&&nshc.inputDisplayElement.id==nshc.certField)nshc.certEncrypt(a);else if("financial"==nshc.inputDisplayElement.getAttribute("decArea")?d.setPublic(nshc.financialRsaPublicKey,nshc.financialRsaExponent):d.setPublic(document.getElementById("nfilter_modulus").value,document.getElementById("nfilter_exponent").value),100<
a.length){c=Number(a.length/100).toFixed(2);for(var e="",f=0;f<c;f++){var h=a.substring(100*f,100*(f+1));e+=d.encrypt(h)}c=e}else c=d.encrypt(a);return c};nshc.RSAKey.prototype.doPublic=nshc.RSADoPublic;nshc.RSAKey.prototype.setPublic=nshc.RSASetPublic;nshc.RSAKey.prototype.encrypt=nshc.RSAEncrypt;
nshc.inputEncryptEcdh=function(a,b){var c,d=c="";if(256==a.length||512==a.length)return a;void 0!=b&&null!=b&&""!=b&&(nshc.inputDisplayElement=b);if(""!=nshc.certField&&nshc.inputDisplayElement.id==nshc.certField)nshc.certEncrypt(a);else if("financial"==nshc.inputDisplayElement.getAttribute("decArea")){c=Base642HexStr(nshc.financialEcdhPublicKey);c=DeriveECKey("secp256r1",nshc.securityPrikey,c);var e=Base642HexStr(document.getElementById("nfilter_modulus").value);e=DeriveECKey("secp256r1",nshc.securityPrikey,
e);1==nshc.uuSessionUse&&(e=HexStr2Base64(e),e=e.substring(0,e.length-4),e=Base642HexStr(e+"+uus"));if(c.length>e.length)for(var f=0;f<c.length-e.length;f++)e+="00";else if(c.length<e.length)for(f=0;f<e.length-c.length;f++)c+="00";for(f=0;f<c.length/2;f++){var h=(parseInt(c.substring(2*f,2*f+2),16)^parseInt(e.substring(2*f,2*f+2),16)).toString(16);d+=1==h.length?"0"+h:h}d=d.substr(0,32);c=1==nshc.NSCryptoUse?SEEDEncrypt(nSaferJS.mode.CFB,d,a):SEEDEncrypt_IV(nSaferJS.mode.CFB,"00000000000000000000000000000000",
d,a)}else c=Base642HexStr(document.getElementById("nfilter_modulus").value),c=DeriveECKey("secp256r1",nshc.securityPrikey,c),c=c.substr(0,32),c=1==nshc.NSCryptoUse?SEEDEncrypt(nSaferJS.mode.CFB,c,a):SEEDEncrypt_IV(nSaferJS.mode.CFB,"00000000000000000000000000000000",c,a);return c};
nshc.setFinancialRsaPublicKey=function(a){a=Base64.decode(a);a=ASN1.decode(a);for(var b=a.sub[1].sub[0].sub[0].posContent(),c=a.sub[1].sub[0].sub[0].length,d=[],e=1;e<c;e++)d.push(a.stream.enc[e+b]);b="";for(e=0;e<c-1;e++){var f=d[e].toString(16);b+=1==f.length?"0"+f:f}nshc.financialRsaPublicKey=b;a=a.sub[1].sub[0].sub[1].content();nshc.financialRsaExponent=Number(a).toString(16)};
nshc.RSAPaddingCheck=function(a){var b=2048==nshc.keyLength?512:256;if(a.length==b)return a;b-=a.length;for(var c=0,d="0";c<b-1;c++)d+="0";return d+a};
nshc.getSubTableData=function(a){for(var b="",c=[],d=new nshc.SubTableHashMap,e=0;e<a.length/10;e++)c[e]=0==e?a.substring(e,e+10):a.substring(10*e,10*e+10);var f=document.getElementsByClassName("nfilter_keypad_div kpdGrp number");f=f[0].childNodes;for(e=0;e<f.length;e++)d.put(f[e].getAttribute("id"),f[e].getAttribute("nfiltercode"));f=document.getElementsByClassName("nfilter_keypad_div kpdGrp lower");f=f[0].childNodes;for(e=0;e<f.length;e++)d.put(f[e].getAttribute("id"),f[e].getAttribute("nfiltercode"));
f=document.getElementsByClassName("nfilter_keypad_div kpdGrp upper");f=f[0].childNodes;for(e=0;e<f.length;e++)d.put(f[e].getAttribute("id"),f[e].getAttribute("nfiltercode"));f=document.getElementsByClassName("nfilter_keypad_div kpdGrp special");f=f[0].childNodes;for(e=0;e<f.length;e++)d.put(f[e].getAttribute("id"),f[e].getAttribute("nfiltercode"));if(0==nshc.subCertEncData)for(e=0;e<c.length;e++)a=d.get(c[e]),"quot"==a&&(a="'"),"apos"==a&&(a='"'),"space"==a&&(a=" "),b+=a;else b=JSON.stringify(d.getAll()),
b=a+"||"+b;return b};nshc.SubTableHashMap=function(){this.map=new Map};nshc.SubTableHashMap.prototype={put:function(a,b){this.map[a]=b},get:function(a){return this.map[a]},getAll:function(){return this.map},clear:function(){this.map=new Map},getKeys:function(){var a=new Map;for(i in this.map)a.push(i);return a}};
nshc.certEncrypt=function(a){if("Netscape"==navigator.appName&&-1!=navigator.userAgent.search("Trident")){var b=nshc.cryptoObj.getRandomValues(new Uint8Array(16));try{nshc.cryptoObj.subtle.generateKey({name:"AES-CBC",length:256},!0,["encrypt","decrypt"]).oncomplete=function(c){var d=c.target.result;nshc.cryptoObj.subtle.encrypt({name:"AES-CBC",iv:b},d,nshc.textEncode(nshc.getSubTableData(a))).oncomplete=function(e){e=new Uint8Array(e.target.result);var f=new Uint8Array(b.byteLength+e.byteLength);
f.set(b,0);f.set(e,16);e=nshc.removeLines(nshc.certPubKey);e=nshc.base64ToArrayBuffer(e);nshc.cryptoObj.subtle.importKey("spki",e,{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!1,["encrypt"]).oncomplete=function(h){var p=h.target.result;nshc.cryptoObj.subtle.exportKey("raw",d).oncomplete=function(g){g=new Uint8Array(g.target.result);nshc.cryptoObj.subtle.encrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},p,g).oncomplete=function(k){k=k.target.result;
"function"==typeof nshc.certEncrypted&&(nshc.certEncrypted(k,f),nshc.clearInput())}}}}}}catch(c){console.log("Error: "+c.message)}}else b=nshc.cryptoObj.getRandomValues(new Uint8Array(16)),nshc.cryptoObj.subtle.generateKey({name:"AES-CBC",length:256},!0,["encrypt","decrypt"]).then(function(c){nshc.cryptoObj.subtle.encrypt({name:"AES-CBC",iv:b},c,nshc.textEncode(nshc.getSubTableData(a))).then(function(d){d=new Uint8Array(d);var e=new Uint8Array(b.byteLength+d.byteLength);e.set(b,0);e.set(d,16);return e}).then(function(d){var e=
nshc.removeLines(nshc.certPubKey);e=nshc.base64ToArrayBuffer(e);nshc.cryptoObj.subtle.importKey("spki",e,{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!1,["encrypt"]).then(function(f){nshc.cryptoObj.subtle.exportKey("raw",c).then(function(h){h=new Uint8Array(h);nshc.cryptoObj.subtle.encrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},f,h).then(function(p){"function"==typeof nshc.certEncrypted&&(nshc.certEncrypted(p,d),nshc.clearInput())})})})})})["catch"](function(c){console.log("Error: "+
c.message)})};nshc.addNewLines=function(a){for(var b="";0<a.length;)b+=a.substring(0,64)+"\n",a=a.substring(64);return b};nshc.removeLines=function(a){return a.replace(/\n/gi,"")};nshc.arrayBufferToBase64=function(a){a=new Uint8Array(a);for(var b="",c=0;c<a.byteLength;c++)b+=String.fromCharCode(a[c]);return window.btoa(b)};nshc.base64ToArrayBuffer=function(a){a=window.atob(a);for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b};
nshc.textEncode=function(a){if(window.TextEncoder)return(new TextEncoder("utf-8")).encode(a);a=unescape(encodeURIComponent(a));for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b};nshc.textDecode=function(a){try{return decodeURIComponent(escape(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(a)))))}catch(c){var b=c;if(b instanceof URIError)return String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(a)));throw b;}};
function testDecrypt(a,b,c){if("Netscape"==navigator.appName&&-1!=navigator.userAgent.search("Trident")){var d=new ArrayBuffer(16),e=new Uint8Array(d);d=new ArrayBuffer(c.length-16);var f=new Uint8Array(d);for(d=0;d<e.length;d++)e[d]=c[d];for(d=0;d<f.length;d++)f[d]=c[d+16];try{nshc.cryptoObj.subtle.importKey("pkcs8",a,{name:"RSA-OAEP",hash:{name:"SHA-256"}},!1,["decrypt"]).oncomplete=function(h){nshc.cryptoObj.subtle.decrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},h.target.result,b).oncomplete=function(p){nshc.cryptoObj.subtle.importKey("raw",
p.target.result,{name:"AES-CBC"},!1,["decrypt"]).oncomplete=function(g){nshc.cryptoObj.subtle.decrypt({name:"AES-CBC",iv:e},g.target.result,f).oncomplete=function(k){k=k.target.result;0==nshc.subCertEncData?alert("AES Decryptoed Data : "+nshc.textDecode(k)):(k=nshc.textDecode(k),alert("AES Decryptoed Data : "+testEncDataToPlainText(k)))}}}}}catch(h){console.log("Error: "+h.message)}}else e=c.slice(0,16),f=c.slice(16),nshc.cryptoObj.subtle.importKey("pkcs8",a,{name:"RSA-OAEP",hash:{name:"SHA-256"}},
!1,["decrypt"]).then(function(h){nshc.cryptoObj.subtle.decrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},h,b).then(function(p){nshc.cryptoObj.subtle.importKey("raw",p,{name:"AES-CBC"},!1,["decrypt"]).then(function(g){nshc.cryptoObj.subtle.decrypt({name:"AES-CBC",iv:e},g,f).then(function(k){0==nshc.subCertEncData?alert("AES Decryptoed Data : "+nshc.textDecode(k)):(k=nshc.textDecode(k),alert("AES Decryptoed Data : "+testEncDataToPlainText(k)))})})})})["catch"](function(h){console.log("Error: "+h.message)})}
;